{% extends 'base.html' %}
{% block title %}More{% endblock %}
{% block description %}Change your profile settings, log out, delete your account and find out how you can contact the developer of LaughLoud{% endblock %}
{% block isSelectedM %}selected{% endblock %}
{% block isSelectedMSm %}selected{% endblock %}
{% block header %}More{% endblock %}
{% block content %}
<div class="profile_settings d-flex flex-column align-items-center border-3 mt-4 py-2">
    <p class="d-flex justify-content-center text-white fs-5 mt-3">Profile settings:</p>
    <form class="d-flex flex-column align-items-center me-md-5" method="post" action="{% url 'home:more' %}">
        {% csrf_token %}
        <div class="container w-100">
            <div class="row mt-2 d-flex align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="username_input" class="text-white fs-5">Username:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="username_input" title="Username" name="profile_name" readonly value="{{profile.username}}" onblur="exitEditMode('username_input', 'username_button_container', 'username_icon')" type="text">
                    <div id="username_button_container"><button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('username_input', 'username_button_container', 'username_icon')"><span id="username_icon" class="fs-4 material-symbols-outlined">edit</span></button></div>
                </div>
            </div>
            <div class="row mt-5 d-flex align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="email_address_input" class="text-white fs-5">E-mail address:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="email_address_input" title="Email" name="profile_email" readonly value="{{profile.email_address}}" onblur="exitEditMode('email_address_input', 'email_address_button_container', 'email_address_icon')" type="email">
                    <div id="email_address_button_container"><button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('email_address_input', 'email_address_button_container', 'email_address_icon')"><span id="email_adress_icon" class="fs-4 material-symbols-outlined">edit</span></button></div>
                </div>
            </div>
            <div class="row mt-5 d-flex align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="fname_input" class="text-white fs-5">Firstname:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="fname_input" title="Firstname" name="profile_firstname" readonly value="{{profile.fname}}" onblur="exitEditMode('fname_input', 'fname_button_container', 'fname_icon')" type="text">
                    <div id="fname_button_container"><button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('fname_input', 'fname_button_container', 'fname_icon')"><span id="fname_icon" class="fs-4 material-symbols-outlined">edit</span></button></div>
                </div>
            </div>
            <div class="row mt-5 d-flex align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="surname_input" class="text-white fs-5">Surname:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="surname_input" title="Surname" name="profile_surname" readonly value="{{profile.surname}}" onblur="exitEditMode('surname_input', 'surname_button_container', 'surname_icon')" type="text">
                    <div id="surname_button_container"><button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('surname_input', 'surname_button_container', 'surname_icon')"><span id="surname_icon" class="fs-4 material-symbols-outlined">edit</span></button></div>
                </div>
            </div>
            <div class="row mt-5 d-flex align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="password_input" class="text-white fs-5">Password:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="password_input" title="Password" name="profile_password" readonly placeholder="Not visible" onblur="exitEditMode('password_input', 'password_button_container', 'password_icon')" type="password">
                    <div id="password_button_container"><button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('password_input', 'password_button_container', 'password_icon')"><span id="password_icon" class="fs-4 material-symbols-outlined">edit</span></button></div>
                </div>
            </div>
            <div id="password_repeat" class="row mt-5 d-none align-items-center justify-content-center">
                <div class="col-12 col-md-4 d-flex justify-content-center">
                    <label for="password_input" class="text-white fs-5">Repeat:</label>
                </div>
                <div class="col-12 col-md-8 mt-4 mt-md-0 d-flex align-items-center justify-content-center">
                    <input style="background-color: rgb(85, 10, 10); height: 40px;" class="fs-5 text-white rounded-4 text-center border-white" required id="password_repeat_input" title="Password repeat" name="profile-repeat_password" readonly type="password">
                </div>
            </div>
            <div class="row mt-5">
                <div class="col-12 d-flex justify-content-center">
                    <button class="own_danger_button rounded-4 border-3 d-inline-block text-white fs-5 px-5 py-2 text-decoration-none" type="submit">Save changes</button>
                </div>
            </div>
            <div class="row mt-5 mb-3">
                <div class="col-12 col-md-6 d-flex justify-content-center"><a href="{% url 'authentication:signout' %}" class="own_warning_button rounded-4 border-3 d-inline-block text-white fs-5 px-5 py-2 text-decoration-none">Log out</a></div>
                <div class="col-12 col-md-6 d-flex justify-content-center mt-3 mt-md-0"><a href="{% url 'authentication:deleteacc' %}" class="own_warning_button rounded-4 border-3 d-inline-block text-white fs-5 px-5 py-2 text-decoration-none">Delete Account</a></div>
            </div>
        </div>
    </form>
</div>
<div class="container mt-2 mt-md-4 fs-5 text-white">
    <p class="d-flex justify-content-center text-center">How to contact the developer of LaughLoud?</p>
    <div class="row mt-4 mt-md-5 d-flex justify-content-center">
        <div class="col-12 col-md-4 d-flex justify-content-center">Discord: rehajel</div>
        <div class="col-12 col-md-4 d-flex justify-content-center">Instagram: rehajel_0511</div>
        <div class="col-12 col-md-4 d-flex justify-content-center mb-3">Email: j.boensch@vodafonemail.de</div>
    </div>
</div>
{% endblock %}

{% block moreScript %}
<script>
    function editMode(input, div, icon) {
        let inputField = document.getElementById(input);  // Needed to set readonly to false
        let buttonContainer = document.getElementById(div);  // Needed to change the button
        let iconField = document.getElementById(icon);  // Needed to set the span ID

        inputField.readOnly = false;
        inputField.focus();  // Cursor enters the input
        buttonContainer.innerHTML = `<button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="exitEditMode('${input}', '${div}', '${icon}')"><span id="${icon}" class="fs-4 material-symbols-outlined">done</span></button>`
        
        if (input == 'password_input') {
            let passwordRepeatField = document.getElementById('password_repeat');
            let passwordRepeatInputField = document.getElementById('password_repeat_input');

            passwordRepeatField.classList.remove('d-none')
            passwordRepeatField.classList.add('d-flex');
            passwordRepeatInputField.readOnly = false
        }

        inputField.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Prevent form submission
                exitEditMode(input, div, icon)
            }
        });
    }

    function exitEditMode(input, div, icon) {
        let inputField = document.getElementById(input);  // Needed to set readonly to true
        let buttonContainer = document.getElementById(div);  // Needed to change the button
        let iconField = document.getElementById(icon);  // Needed to set the span ID
        
        inputField.readOnly = true;
        buttonContainer.innerHTML = `<button class="changeMode btn ms-md-5 ms-3 d-flex justifiy-content-center align-items-center text-white border-white" type="button" onclick="editMode('${input}', '${div}', '${icon}')"><span id="${icon}" class="fs-4 material-symbols-outlined">edit</span></button>`
    
        if (input != 'password_input') {
            let passwordRepeatInputField = document.getElementById('password_repeat_input');
            passwordRepeatInputField.readOnly = true
        }
    }
</script>
{% endblock %}